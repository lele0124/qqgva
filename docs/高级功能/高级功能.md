
# 高级功能

<cite>
**本文档中引用的文件**
- [ast.go](file://server/utils/ast/ast.go)
- [auto_code_mcp.go](file://server/service/system/auto_code_mcp.go)
- [mcp.go](file://server/config/mcp.go)
- [auto_code_mcp.go](file://server/api/v1/system/auto_code_mcp.go)
- [plugin.go](file://server/utils/plugin/plugin.go)
- [plugin.go](file://server/utils/plugin/v2/plugin.go)
- [sys_auto_code.go](file://server/model/system/request/sys_auto_code.go)
- [sys_auto_code_package.go](file://server/model/system/request/sys_auto_code_package.go)
</cite>

## 目录
1. [自动代码生成器](#自动代码生成器)
2. [插件系统架构](#插件系统架构)
3. [MCP (Model Context Protocol)](#mcp-model-context-protocol)
4. [Swagger API 文档](#swagger-api-文档)

## 自动代码生成器

gin-vue-admin 的自动代码生成器基于 Go 语言的 AST（抽象语法树）技术实现，能够解析、修改和生成 Go 源代码。该系统通过 `utils/ast` 包中的工具函数和结构体来操作源码文件，实现自动化注入。

核心工作流程包括：
1. **AST 解析**：使用 `go/parser` 解析目标 Go 文件，构建抽象语法树。
2. **代码注入**：通过 `ast.Inspect` 遍历语法树，定位特定节点（如函数、变量、结构体等），并插入新的代码片段。
3. **模板渲染**：利用 Go 的 `text/template` 包，将用户定义的数据模型与预设的代码模板结合，生成前后端代码。
4. **文件写入**：将修改后的 AST 格式化为源代码，并写入指定路径。

例如，在注册新路由时，系统会调用 `AddRouterCode` 函数，动态地在 `router.go` 文件中添加路由变量和初始化语句；在集成 GORM 模型时，则通过 `AddRegisterTablesAst` 函数向 `gorm_biz.go` 注册数据库迁移。

**Section sources**
- [ast.go](file://server/utils/ast/ast.go#L1-L307)
- [ast_router.go](file://server/utils/ast/ast_router.go#L1-L136)
- [ast_gorm.go](file://server/utils/ast/ast_gorm.go#L1-L167)

## 插件系统架构

gin-vue-admin 支持 V1 和 V2 两种插件模式，开发者可以基于此框架开发自定义插件并进行打包集成。

### V1 插件
V1 插件遵循 `server/utils/plugin/plugin.go` 中定义的 `Plugin` 接口：
```go
type Plugin interface {
	Register(group *gin.RouterGroup)
	RouterPath() string
}
```
插件需实现 `Register` 方法以注册其路由，并通过 `RouterPath()` 返回路由前缀。初始化时，系统会在 `initialize/plugin_biz_v1.go` 中加载所有 V1 插件并调用其注册方法。

### V2 插件
V2 插件接口更为简洁，定义于 `server/utils/plugin/v2/plugin.go`：
```go
type Plugin interface {
	Register(group *gin.Engine)
}
```
V2 插件直接接收整个 Gin 引擎实例，拥有更高的控制权限。其初始化逻辑位于 `initialize/plugin_biz_v2.go`。

插件开发通常包含以下目录结构：
- `api/`: 定义 RESTful 接口
- `router/`: 路由注册
- `service/`: 业务逻辑处理
- `model/`: 数据模型定义
- `initialize/`: 初始化逻辑（如数据库、菜单、GORM 等）

插件可通过 `plugin_gen.go` 工具自动生成基础骨架，简化开发流程。

**Section sources**
- [plugin.go](file://server/utils/plugin/plugin.go#L1-L17)
- [plugin.go](file://server/utils/plugin/v2/plugin.go#L1-L10)
- [plugin_gen.go](file://server/utils/ast/plugin_gen.go#L1-L50)

## MCP (Model Context Protocol)

MCP（Model Context Protocol）是 gin-vue-admin 提供的一项高级特性，旨在支持 AI 辅助开发。它允许开发者通过结构化的 JSON 输入，自动生成 MCP 工具代码