# Dialogue 项目功能总结

## 1. 项目概述

Dialogue 是一个自动化的对话总结工具，用于监控指定目录中的对话文件，提取对话中的问题和解决方案，并将其结构化地记录到项目提示词记录文件中。这个工具主要用于帮助开发者整理和归档技术问题及其解决方案。

## 2. 核心功能

### 2.1 自动监控与处理
- 持续监控 Dialogue 目录中的新文件
- 自动识别并处理新增的对话文件
- 避免重复处理已记录的文件
- 支持定时扫描（默认每分钟检查一次）

### 2.2 对话内容分析
- 解析对话文件内容，识别用户问题和助手回答
- 支持多种对话标识符格式：
  - 用户提问：`用户:`、`USER:`、`提问:`
  - 助手回答：`助手:`、`ASSISTANT:`、`回答:`
- 从回答中提取涉及的文件路径信息

### 2.3 结构化记录生成
- 将对话内容转换为标准化的 Markdown 格式
- 自动生成包含问题描述、解决过程和涉及文件的结构化记录
- 在记录中添加来源文件和更新时间的元信息

### 2.4 配置管理
- 支持通过环境变量配置路径
- 自动检测项目根目录和相关文件路径
- 可通过命令行参数自定义配置

## 3. 项目架构

### 3.1 目录结构
```
Dialogue/
├── cmd/                 # 命令行入口
├── internal/            # 核心逻辑
│   ├── config/          # 配置管理
│   └── summarizer/      # 总结处理逻辑
├── scripts/             # 启动脚本
└── README.md            # 说明文档
```

### 3.2 核心组件

1. **主程序** ([cmd/summary_tool.go](file:///Users/menqqq/code/cloned/gin-vue-admin/Dialogue/cmd/summary_tool.go)):
   - 程序入口点
   - 处理命令行参数
   - 控制定时扫描逻辑
   - 信号处理和优雅退出

2. **配置管理** ([internal/config/config.go](file:///Users/menqqq/code/cloned/gin-vue-admin/Dialogue/internal/config/config.go)):
   - 管理对话目录、记录文件路径等配置
   - 支持环境变量和自动路径检测
   - 提供默认配置值

3. **对话处理** ([internal/summarizer/processor.go](file:///Users/menqqq/code/cloned/gin-vue-admin/Dialogue/internal/summarizer/processor.go)):
   - 解析对话内容
   - 提取问题和解决方案
   - 识别涉及的文件路径
   - 生成结构化记录内容

4. **文件处理** ([internal/summarizer/file_handler.go](file:///Users/menqqq/code/cloned/gin-vue-admin/Dialogue/internal/summarizer/file_handler.go)):
   - 处理单个对话文件
   - 扫描目录中的文件
   - 跟踪已处理的文件
   - 更新项目记录文件

5. **启动脚本** ([scripts/start_summary_tool.sh](file:///Users/menqqq/code/cloned/gin-vue-admin/Dialogue/scripts/start_summary_tool.sh)):
   - 环境检查
   - 路径设置
   - 程序启动

## 4. 工作流程

### 4.1 初始化阶段
- 加载配置（环境变量或默认值）
- 读取项目记录文件，获取已处理文件列表
- 扫描现有对话文件并处理未记录的文件

### 4.2 监控阶段
- 按设定间隔（默认60秒）扫描对话目录
- 识别新文件并进行处理
- 将处理结果追加到项目记录文件

### 4.3 处理过程
- 读取对话文件内容
- 解析对话结构，提取问题和回答
- 从回答中提取涉及的文件路径
- 生成标准化的 Markdown 记录
- 更新项目记录文件

## 5. 输出格式

工具生成的记录格式如下：

```markdown
## 问题标题

### 问题描述
用户的问题内容

### 解决过程
1. 解决方案步骤一
2. 解决方案步骤二
...

### 涉及文件
- 相关文件列表

<!-- 来源文件: 对话文件路径, 更新时间: YYYY-MM-DD HH:MM:SS -->
```

## 6. 特色功能

### 6.1 智能路径检测
- 自动向上查找项目根目录
- 支持环境变量自定义路径
- 默认路径适配 gin-vue-admin 项目结构

### 6.2 灵活的对话格式支持
- 支持多种中英文对话标识符
- 能处理多轮对话
- 智能识别回答中的文件路径

### 6.3 避免重复处理
- 通过记录文件中的元信息跟踪已处理文件
- 首次运行时处理现有文件
- 后续运行只处理新增文件

### 6.4 可扩展性
- 模块化设计，便于功能扩展
- 清晰的接口定义
- 支持命令行参数自定义行为

## 7. 使用场景

### 7.1 技术问题归档
- 自动整理开发过程中的技术问答
- 形成可搜索的知识库

### 7.2 项目文档生成
- 自动生成项目常见问题及解决方案文档
- 便于新成员快速了解项目

### 7.3 经验总结
- 积累和沉淀项目开发经验
- 形成可复用的解决方案库

这个工具通过自动化处理对话内容，大大减少了手动整理技术文档的工作量，同时确保了文档格式的一致性，是一个非常实用的开发辅助工具。